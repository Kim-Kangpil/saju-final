// frontend/data/strengthAnalysis.ts

export const STRENGTH_ANALYSIS = {
  empathy: {
    title: "흔들리지 않는 당신만의 단단한 내면의 힘",
    icon: "💪",
  },
  reality: {
    title: "내부 멘탈 코어의 밀도 및 주체성 로직 진단",
    icon: "🧠",
  },
  fun: {
    title: "고집 좀 세면 어때? 흔들리지 않는 네 멘탈이 무기다!",
    icon: "🔥",
  },
};

// 월령 왕쇠표 (일간이 월지에서 받는 힘)
const 월령왕쇠표: Record<string, Record<string, number>> = {
  "甲": { "寅": 20, "卯": 20, "辰": 10, "亥": 15, "子": 10, "未": 5, "午": 5, "巳": 0, "申": -10, "酉": -10, "戌": 5, "丑": 5 },
  "乙": { "卯": 20, "寅": 15, "辰": 10, "未": 10, "亥": 10, "子": 5, "午": 0, "巳": 0, "申": -10, "酉": -10, "戌": 5, "丑": 5 },
  "丙": { "巳": 20, "午": 20, "寅": 15, "未": 10, "戌": 10, "卯": 10, "辰": 5, "丑": 0, "申": -10, "酉": -10, "子": -15, "亥": -10 },
  "丁": { "午": 20, "巳": 15, "未": 10, "戌": 10, "寅": 10, "卯": 5, "辰": 0, "丑": 0, "申": -10, "酉": -10, "子": -15, "亥": -10 },
  "戊": { "辰": 20, "戌": 20, "丑": 15, "未": 15, "午": 10, "巳": 10, "寅": 5, "卯": 0, "申": 0, "酉": 0, "子": -10, "亥": -10 },
  "己": { "未": 20, "辰": 15, "戌": 15, "丑": 15, "午": 10, "巳": 5, "寅": 0, "卯": 0, "申": 0, "酉": 0, "子": -10, "亥": -10 },
  "庚": { "申": 20, "酉": 20, "辰": 10, "戌": 10, "丑": 10, "未": 5, "巳": 5, "午": 0, "寅": -10, "卯": -10, "子": 5, "亥": 0 },
  "辛": { "酉": 20, "申": 15, "辰": 10, "戌": 10, "丑": 10, "未": 5, "巳": 0, "午": 0, "寅": -10, "卯": -10, "子": 5, "亥": 5 },
  "壬": { "子": 20, "亥": 20, "申": 15, "辰": 10, "丑": 10, "酉": 5, "寅": 5, "卯": 0, "午": -15, "巳": -10, "未": -5, "戌": -5 },
  "癸": { "亥": 20, "子": 15, "申": 10, "辰": 10, "丑": 10, "酉": 5, "寅": 0, "卯": 0, "午": -15, "巳": -10, "未": -5, "戌": -5 },
};

// 십성별 점수 (간단 버전)
function getTenGodScore(god: string): number {
  const scores: Record<string, number> = {
    "비견": 10,
    "겁재": 10,
    "정인": 8,
    "편인": 8,
    "식신": -5,
    "상관": -5,
    "정재": -8,
    "편재": -8,
    "정관": -10,
    "편관": -10,
  };
  return scores[god] || 0;
}

// 신강신약 판정 함수
export function analyzeStrength(
  dayStem: string,
  monthBranch: string,
  pillars: Array<{ cheongan: { hanja: string }; jiji: { hanja: string } }>,
  tenGodFunc: (dayStem: string, targetStem: string) => string
): {
  type: "신강" | "신약" | "중화";
  score: number;
  empathy: string;
  reality: string;
  fun: string;
  recommendation: string;
} {
  let score = 50; // 기본 50점

  // 1. 월령(월지) 득령 여부 체크
  const monthScore = 월령왕쇠표[dayStem]?.[monthBranch] || 0;
  score += monthScore;

  // 2. 사주 천간의 십성 체크
  pillars.forEach(pillar => {
    const god = tenGodFunc(dayStem, pillar.cheongan.hanja);
    score += getTenGodScore(god);
  });

  // 3. 판정
  let type: "신강" | "신약" | "중화";
  if (score >= 70) {
    type = "신강";
  } else if (score <= 40) {
    type = "신약";
  } else {
    type = "중화";
  }

  // 4. 설명
  const descriptions = {
    신강: {
      empathy: "당신은 스스로를 지키는 힘이 강해요. 혼자서도 잘 해낼 수 있는 단단한 사람입니다. 외부의 영향을 크게 받지 않고, 자신의 소신대로 살아가는 힘이 있어요. 때로는 고집스러워 보일 수 있지만, 그것이 당신의 강점이에요.",
      reality: `멘탈 코어 밀도: ${score}점. 자립성 우수. 독립적 의사결정 능력 최상위. 외부 압력에 대한 저항력 높음. 자기주도적 목표 달성 능력 탁월. 리더십 발휘 시 효과 극대화.`,
      fun: "넌 혼자서도 잘 버텨! 그 고집 좀 세 보이지만 그게 네 무기야! 남 의견 안 들어도 네 길 가면 돼! 근데 가끔은 좀 들어줘라 ㅋㅋ",
      recommendation: "독립적인 일이 잘 맞아요. 창업, 프리랜서, 자영업 등 스스로 결정하고 책임지는 일에서 빛나요. 다만 너무 고집부리지 말고 타협도 배우세요.",
    },
    신약: {
      empathy: "부드럽고 유연한 당신. 다른 사람의 도움을 받아 더 큰 꽃을 피울 수 있어요. 혼자 힘들 때는 주저 없이 손을 내미세요. 도움을 받는 것은 약함이 아니라 지혜로움이에요. 협력할 때 당신의 진가가 발휘됩니다.",
      reality: `멘탈 코어 밀도: ${score}점. 협력형 구조. 외부 지원 시 시너지 극대화. 팀워크 환경에서 성과 증폭. 멘토링 및 네트워킹 활용 권장. 조직 내 협업 능력 우수.`,
      fun: "혼자 힘들 땐 도움 받아! 부끄러워하지 마, 그게 더 현명한 거야! 팀플 잘하잖아? 그게 네 장점이야! 혼자 끙끙대지 말고 같이해!",
      recommendation: "팀워크가 중요한 일이 잘 맞아요. 대기업, 공무원, 조직 생활에서 능력 발휘. 좋은 멘토를 만나면 큰 성공 가능. 인맥을 잘 활용하세요.",
    },
    중화: {
      empathy: "균형 잡힌 내면을 가졌어요. 필요에 따라 강하기도, 부드럽기도 한 사람입니다. 상황에 맞게 유연하게 대응할 수 있는 능력이 당신의 가장 큰 장점이에요. 어떤 환경에서도 적응할 수 있어요.",
      reality: `멘탈 코어 밀도: ${score}점. 균형형. 상황 대응력 우수. 독립/협력 모두 가능한 멀티 모드. 환경 적응력 최상위. 다양한 분야에서 안정적 성과 예상.`,
      fun: "넌 밸런스가 좋아! 혼자도 되고 같이도 잘해! 완전 만능캐! 상황 봐서 알아서 잘하는 게 네 재능이야!",
      recommendation: "다양한 분야에서 활약 가능. 상황에 맞게 독립/협력을 선택할 수 있어요. 폭넓은 경험을 쌓으면 더 큰 성공 가능.",
    },
  };

  return {
    type,
    score,
    empathy: descriptions[type].empathy,
    reality: descriptions[type].reality,
    fun: descriptions[type].fun,
    recommendation: descriptions[type].recommendation,
  };
}
